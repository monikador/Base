"undefined"==typeof window.Mozilla&&(window.Mozilla={}),function(){"use strict";var u={COOKIE_CODE_ID:"moz-stub-attribution-code",COOKIE_SIGNATURE_ID:"moz-stub-attribution-sig"};u.experimentName,u.experimentVariation,u.withinAttributionRate=function(){return Math.random()<u.getAttributionRate()},u.getAttributionRate=function(){var t=$("html").attr("data-stub-attribution-rate");return isNaN(t)?0:Math.min(Math.max(parseFloat(t),0),1)},u.hasCookie=function(){return Mozilla.Cookies.hasItem(u.COOKIE_CODE_ID)&&Mozilla.Cookies.hasItem(u.COOKIE_SIGNATURE_ID)},u.setCookie=function(t){if(t.attribution_code&&t.attribution_sig){var e=new Date;e.setTime(e.getTime()+864e5);var i=e.toUTCString();Mozilla.Cookies.setItem(u.COOKIE_CODE_ID,t.attribution_code,i,"/"),Mozilla.Cookies.setItem(u.COOKIE_SIGNATURE_ID,t.attribution_sig,i,"/")}},u.getCookie=function(){return{attribution_code:Mozilla.Cookies.getItem(u.COOKIE_CODE_ID),attribution_sig:Mozilla.Cookies.getItem(u.COOKIE_SIGNATURE_ID)}},u.updateBouncerLinks=function(o){o.attribution_code&&o.attribution_sig&&u.meetsRequirements()&&$(".download-list .download-link, .c-button-download-thanks .download-link, .download-platform-list .download-link").each(function(){var t,e,i=this;i.href&&-1!==i.href.indexOf("https://download.mozilla.org")?(t=i.getAttribute("data-download-version"))&&/win/.test(t)&&(i.href=Mozilla.StubAttribution.appendToDownloadURL(i.href,o)):i.href&&-1!==i.href.indexOf("/firefox/download/thanks/")&&(e=i.getAttribute("data-direct-link"))&&i.setAttribute("data-direct-link",Mozilla.StubAttribution.appendToDownloadURL(e,o))})},u.appendToDownloadURL=function(i,t){return t.attribution_code&&t.attribution_sig&&$.each(t,function(t,e){"attribution_code"!==t&&"attribution_sig"!==t||(i+=(-1<i.indexOf("?")?"&":"?")+t+"="+e)}),i},u.onRequestSuccess=function(t){t.attribution_code&&t.attribution_sig&&(u.updateBouncerLinks(t),u.setCookie(t))},u.requestAuthentication=function(t){var e=window.location.protocol+"//"+window.location.host+"/en-US/firefox/stub_attribution_code/";$.get(e,t).done(u.onRequestSuccess)},u.getUserAgent=function(t){return t=void 0!==t?t:navigator.userAgent,/MSIE|Trident/i.test(t)?"ie":/Edg|Edge/i.test(t)?"edge":/Firefox/.test(t)?"firefox":/Chrome/.test(t)?"chrome":"other"},u.getAttributionData=function(t){var e=new window._SearchParams,i=e.utmParams(),o=e.get("experiment")||u.experimentName,n=e.get("variation")||u.experimentVariation,a=void 0!==t?t:document.referrer,r=u.getUserAgent();return{utm_source:i.utm_source,utm_medium:i.utm_medium,utm_campaign:i.utm_campaign,utm_content:i.utm_content,referrer:a,ua:r,experiment:o,variation:n}},u.isFirefoxNewScene2=function(t){return-1<(t=void 0!==t?t:window.location.href).indexOf("/firefox/download/thanks/")},u.meetsRequirements=function(){return"undefined"!=typeof window.site&&"undefined"!=typeof Mozilla.Cookies&&(!!Mozilla.Cookies.enabled()&&("windows"===window.site.platform&&!Mozilla.dntEnabled()))},u.init=function(){var t={};u.meetsRequirements()&&(u.hasCookie()?(t=u.getCookie(),u.updateBouncerLinks(t)):u.isFirefoxNewScene2()||(t=u.getAttributionData())&&u.withinAttributionRate()&&u.requestAuthentication(t))},window.Mozilla.StubAttribution=u}(),function(){"use strict";Mozilla.StubAttribution.init()}();